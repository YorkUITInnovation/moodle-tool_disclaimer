{"version":3,"file":"disclaimer_alert.min.js","sources":["../src/disclaimer_alert.js"],"sourcesContent":["import notification from 'core/notification';\nimport ModalFactory from 'core/modal_factory';\nimport Templates from 'core/templates';\nimport ajax from 'core/ajax';\nimport config from 'core/config';\n\nexport const init = async (data) => {\n    // Set paramaters for template\n    let params = {\n        subject: data.subject,\n        message: data.message,\n        disclaimerid: data.id,\n        userid: data.userid,\n    };\n    const modal = await ModalFactory.create({\n        title: data.subject,\n        body: Templates.render('tool_disclaimer/modal_buttons', params),\n        footer: 'Nothing',\n    });\n    modal.show();\n\n    // If the user clicks the button with attribute data-action=\"hide\", the modal will be hidden\n    document.querySelector('[data-action=\"hide\"]').addEventListener('click', () => {\n        respond(data.id, data.userid, null);\n        // if dataredirecto is set, redirect to the page\n        if (data.redirectto) {\n            window.location.href = config.wwwroot + data.redirectto;\n        }\n    });\n\n    // When button with class btn-tool-disclaimer-cancel is clicked, the modal will be hidden\n    document.getElementById('btn-tool-disclaimer-cancel').addEventListener('click', () => {\n        respond(data.id, data.userid, null);\n        modal.hide();\n        if (data.redirectto) {\n            window.location.href = config.wwwroot + data.redirectto;\n        }\n    });\n\n    // When Button with id btn-tool-disclaimer-yes is clicked, the modal will be hidden\n    document.getElementById('btn-tool-disclaimer-yes').addEventListener('click', () => {\n        respond(data.id, data.userid, 1);\n        modal.hide();\n    });\n\n    // When Button with id btn-tool-disclaimer-no is clicked, the modal will be hidden\n    document.getElementById('btn-tool-disclaimer-no').addEventListener('click', () => {\n        respond(data.id, data.userid, 0);\n        modal.hide();\n        if (data.redirectto) {\n            window.location.href = config.wwwroot + data.redirectto;\n        }\n    });\n\n};\n\n/**\n * Make ajax call to save the response of the user\n * @param {number} disclaimerid\n * @param {number} userid int\n * @param {string} response\n */\nfunction respond(disclaimerid, userid, response) {\n    var saveResponse = ajax.call([{\n        methodname: 'tool_disclaimer_response',\n        args: {\n            userid: userid,\n            disclaimerid: disclaimerid,\n            response: response\n        }\n    }]);\n    saveResponse[0].done(function () {\n        // do nothing\n    }).fail(function () {\n        notification.alert('Could not save response');\n    });\n}"],"names":["respond","disclaimerid","userid","response","ajax","call","methodname","args","done","fail","alert","async","params","subject","data","message","id","modal","ModalFactory","create","title","body","Templates","render","footer","show","document","querySelector","addEventListener","redirectto","window","location","href","config","wwwroot","getElementById","hide"],"mappings":"gmBA8DSA,QAAQC,aAAcC,OAAQC,UAChBC,cAAKC,KAAK,CAAC,CAC1BC,WAAY,2BACZC,KAAM,CACFL,OAAQA,OACRD,aAAcA,aACdE,SAAUA,aAGL,GAAGK,MAAK,eAElBC,MAAK,iCACSC,MAAM,4CApEPC,MAAAA,WAEZC,OAAS,CACTC,QAASC,KAAKD,QACdE,QAASD,KAAKC,QACdd,aAAca,KAAKE,GACnBd,OAAQY,KAAKZ,cAEXe,YAAcC,uBAAaC,OAAO,CACpCC,MAAON,KAAKD,QACZQ,KAAMC,mBAAUC,OAAO,gCAAiCX,QACxDY,OAAQ,YAEZP,MAAMQ,OAGNC,SAASC,cAAc,wBAAwBC,iBAAiB,SAAS,KACrE5B,QAAQc,KAAKE,GAAIF,KAAKZ,OAAQ,MAE1BY,KAAKe,aACLC,OAAOC,SAASC,KAAOC,gBAAOC,QAAUpB,KAAKe,eAKrDH,SAASS,eAAe,8BAA8BP,iBAAiB,SAAS,KAC5E5B,QAAQc,KAAKE,GAAIF,KAAKZ,OAAQ,MAC9Be,MAAMmB,OACFtB,KAAKe,aACLC,OAAOC,SAASC,KAAOC,gBAAOC,QAAUpB,KAAKe,eAKrDH,SAASS,eAAe,2BAA2BP,iBAAiB,SAAS,KACzE5B,QAAQc,KAAKE,GAAIF,KAAKZ,OAAQ,GAC9Be,MAAMmB,UAIVV,SAASS,eAAe,0BAA0BP,iBAAiB,SAAS,KACxE5B,QAAQc,KAAKE,GAAIF,KAAKZ,OAAQ,GAC9Be,MAAMmB,OACFtB,KAAKe,aACLC,OAAOC,SAASC,KAAOC,gBAAOC,QAAUpB,KAAKe"}