define("tool_disclaimer/disclaimer_alert",["exports","core/notification","core/modal_factory","core/templates","core/ajax","core/config"],(function(_exports,_notification,_modal_factory,_templates,_ajax,_config){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=_interopRequireDefault(_notification),_modal_factory=_interopRequireDefault(_modal_factory),_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax),_config=_interopRequireDefault(_config);function respond(disclaimerid,userid,response,objectid){let redirectto=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";console.log("respond",disclaimerid,userid,response,objectid,redirectto),void 0===objectid&&(console.log("objectid is undefined"),objectid=0);const args={userid:userid,disclaimerid:disclaimerid,response:response,objectid:objectid};console.log("args",JSON.stringify(args));var saveResponse=_ajax.default.call([{methodname:"tool_disclaimer_response",args:args}]);saveResponse[0].done((function(){redirectto&&(window.location.href=_config.default.wwwroot+redirectto)})).fail((function(){_notification.default.alert("Could not save response")}))}_exports.init=async results=>{var disclaimerid,userid,params=await(disclaimerid=results.disclaimerid,userid=results.userid,new Promise(((resolve,reject)=>{_ajax.default.call([{methodname:"tool_disclaimer_get_disclaimer",args:{id:disclaimerid}}])[0].done((function(data){data.userid=userid,resolve(data)})).fail((function(){_notification.default.alert("Could not get disclaimer"),reject()}))})));params.objectid=results.objectid;const modal=await _modal_factory.default.create({title:params.subject,body:_templates.default.render("tool_disclaimer/disclaimer_modal",params),footer:_templates.default.render("tool_disclaimer/modal_buttons",params)});function hideModal(){modal.destroy();for(var backdrops=document.getElementsByClassName("modal-backdrop");backdrops[0];)backdrops[0].parentNode.removeChild(backdrops[0])}modal.getRoot().modal({backdrop:"static",keyboard:!1}),modal.show(),await new Promise((resolve=>setTimeout(resolve,2e3))),await document.querySelector('[data-action="hide"]').addEventListener("click",(()=>{respond(params.id,params.userid,0,params.objectid,params.redirectto),hideModal()})),await document.getElementById("btn-tool-disclaimer-cancel").addEventListener("click",(()=>{respond(params.id,params.userid,0,params.objectid,params.redirectto),hideModal()})),await document.getElementById("btn-tool-disclaimer-yes").addEventListener("click",(()=>{respond(params.id,params.userid,1,params.objectid,""),hideModal()})),await document.getElementById("btn-tool-disclaimer-no").addEventListener("click",(()=>{respond(params.id,params.userid,2,params.objectid,params.redirectto),hideModal()}))}}));

//# sourceMappingURL=disclaimer_alert.min.js.map